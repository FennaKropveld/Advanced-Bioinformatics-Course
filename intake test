#Plotting
spt7<- read.delim("spt7.txt", stringsAsFactors = F, row.names = 1)
plot(x=spt7$wt, y=spt7$spt7.del,  main = "Spt7_del vs wt", ylab = "SPT7_del", xlab = "WT")
down <- spt7$spt7.del - spt7$wt <= -1
up <- spt7$spt7.del - spt7$wt >= 1
#any gene that went down in the deletion strain with more then 1 will be true in the index down
#any gene that went up in the deletion strain with more then 1 will be true in the index up
points(x= spt7[down,"wt"], y = spt7[down,"spt7.del"] , col= "green")
points(x= spt7[up, "wt"], y = spt7[up,"spt7.del"] , col= "red" )

#Counting genes
SGD <- read.delim("SGD.txt", stringsAsFactors = F, row.names = 1)
#for each of the chromosomes, i loop through the SGD file and make an index 
#of which rows belong to that chromosome, and are of the "gene" type
#since TRUE == 1, the sum of the index of each chromosome is equal to the amount of genes
for (chr in unique(SGD$chromosome)){
  idx <- SGD$chromosome == chr & SGD$type == "gene"
  if (chr == ""){
    cat(sum(idx),"genes are unmapped\n")
  }
  else{
      cat("chromosome ", chr, "has",  sum(idx),"genes\n")
  } 
} 

#Exporting genomic features to a file
#first, the function makes an index of which rows in the table are of the right type
#then, for those rows, it makes a subtable containing only the columns of interest (sysname, chrname,strand, etc)
#finally, it writes the data in a tab seperated file
FileWriter <-function (x, file.name, feature.type){
  xsubidx <- x["type"] == feature.type
  xsub    <- x[xsubidx, c("systematicName", "parent.feature.name", "strand", "start", "stop")]
  write.table(xsub, file = file.name, sep = "\t", append = T, row.names = F)
}
#an example
FileWriter(SGD,"output_SGD.txt","gene")
